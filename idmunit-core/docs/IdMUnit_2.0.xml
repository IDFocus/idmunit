<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<book>
  <bookinfo>
    <title>IdMUnit Usage Guide</title>

    <author>
      <firstname>Brent</firstname>

      <surname>Kynaston</surname>

      <affiliation>
        <orgname>TriVir, LLC</orgname>

        <address>11570 Popes Head View Lane
Fairfax, VA
22030
<country>USA</country>,
Phone: 703-608-3498
Fax: 703-991-7134,
Web: <otheraddr><ulink url="http://www.idmunit.org">www.idmunit.org</ulink></otheraddr>
Web: <otheraddr><ulink url="http://www.trivir.com">www.trivir.com</ulink></otheraddr>
Email: <email>info@trivir.com</email></address>
      </affiliation>
    </author>

    <pubdate>May 4 2009</pubdate>

    <abstract>
      <para>This document contains installation and usage instructions for
      IdMUnit, an automated test framework for Identity Management (IdM)
      systems. Additional training and documentation is available through
      IdMUnit training and consulting. Request more information at
      info@trivir.com</para>

      <para>This document contains instructions for the installation and basic
      use of IdMUnit. More information can be obtained by emailing
      info@trivir.com or going to www.IdMUnit.org.</para>

      <para>License information:</para>

      <para>IdMUnit - Automated Testing Framework for Identity Management
      Solutions Copyright (c) 2005-2009 TriVir, LLC</para>

      <para>This program is licensed under the terms of the GNU General Public
      License Version 2 (the "License") as published by the Free Software
      Foundation, and the TriVir Licensing Policies (the "License Policies").
      A copy of the License and the Policies were distributed with this
      program. Designer and Identity Manager are registered trademarks of
      Novell, Inc. Microsoft and Excel are registered trademarks of Microsoft
      Corporation. OpenOffice.org is a trademark of Team OpenOffice.org.
      IdMUnit is a registered trademark of TriVir, LLC.</para>

      <para>Information about IdMUnit or the open source project may be found
      at www.idmunit.org and <ulink
      url="http://sourceforge.net/projects/idmunit/">http://sourceforge.net/projects/idmunit/</ulink></para>

      <para><inlinemediaobject>
          <imageobject>
            <imagedata fileref="./images/IDMUNIT_LOGOmed.bmp" />
          </imageobject>
        </inlinemediaobject></para>
    </abstract>
  </bookinfo>

  <chapter>
    <title>Introduction</title>

    <para>IdMUnit is a must-have automated testing tool that integrates with
    Designer for Identity Manager. This suite, based on xUnit
    architecture, will automatically transform documented test cases
    into actual automated tests, execute them, and record the results
    (pass/fail/warning) in text and/or HTML output. This suite provides
    integrated policy, driver and system testing to accelerate the project
    release time-frame, ease development risk, control scope, and ensure
    logical compliance with functional requirements from design until
    deployment and beyond. Complete functional testing can now be completed
    for the entire identity management solution in seconds rather than
    weeks.</para>

    <para>IdMUnit provides a quality-control compliment to Identity Manager as
    it quickly certifies that installed drivers are functioning according to
    business rules and solution specifications. It also works with TriVir's
    Data Comparator, which validates the state of every synchronized object
    and attribute to ensure that synchronization is working as expected
    throughout connected production systems.</para>

    <para>This software is developed and maintained by TriVir. TriVir
    maintains two versions of IdMUnit, a customer and an open source
    version. New features and updates are made regularly to the customer
    version of the code. When enough changes are accumulated in the
    customer version of the code then the Open Source version is updated
    with the changes from the customer version.</para>
  </chapter>

  <chapter id="install">
    <title>Installation</title>

    <para>These installation instructions cover installing IdMUnit into
    Designer for Novell Identity Manager. IdMUnit can also be executed using a
    command line interface, but that is not covered as part of this
    document.</para>

    <section id="installing_xxe">
      <title>Installing IdMUnit</title>

      <section>
        <title>Requirements</title>

        <itemizedlist>
          <listitem>
            <para>Any operating system supported by Designer for Novell
            Identity Manager</para>
          </listitem>

          <listitem>
            <para>At least a 1GHz CPU</para>
          </listitem>

          <listitem>
            <para>At least 1024Mb of RAM</para>
          </listitem>

          <listitem>
            <para>40Mb of free disk space</para>
          </listitem>
        </itemizedlist>

        <para>IdMUnit has been tested with:</para>

        <itemizedlist>
          <listitem>
            <para><ulink url="http://java.sun.com/j2se/">Sun
            <trademark>Java</trademark></ulink> runtime 1.5+ (up to 1.6.0_07)
            under Windows 2000, XP, Vista, openSUSE Linux 10.2, SUSE Linux
            Enterprise Desktop 10.x and SUSE Linux Enterprise Server.</para>
          </listitem>

          <listitem>
            <para>Command line version tested on multiple revisions of Solaris
            and NetWare in addition to the platforms listed above.</para>
          </listitem>

          <listitem>
            <para>Designer versions 1.2, 2.1.1 and 3.0.x (including multiple
            iteration release candidates)</para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Installing Eclipse Overlay</title>

        <tip>
          <para>Installing into a virtual machine will provide maximum
          portability and the ability to take configuration snapshots at
          desired intervals</para>
        </tip>

        <procedure>
          <step>
            <para>Download the desired Eclipse overlay (with at least the Java
            development plug-ins). The tested overlay may be download from
            here:</para>

            <para>Click on the "Eclipse IDE for Java Developers" link on this
            page: <ulink
            url="http://www.eclipse.org/downloads/packages/release/europa/winter">Eclipse
            Europa</ulink><tip>
                <para>The Europa release tends to package all of the necessary
                related dependencies for Eclipse and the additional packages
                required by Designer</para>
              </tip></para>
          </step>

          <step>
            <para>Apply the Eclipse overlay on top of Designer</para>

            <para><tip>
                <para>Backing up the config.ini found in
                Designer/eclipse/configuration and restoring it after the
                overlay will maintain the Designer branding and
                packaging</para>
              </tip></para>

            <para>Copy the folders found in ECLIPSE EXTRACT/eclipse (i.e.
            configuration, features, plugins and readme) to the
            Designer/eclipse folder, overwriting all files.</para>

            <para><tip>
                <para>Restore the Designer/eclipse/configuration/config.ini
                file to regain the Designer look &amp; feel</para>
              </tip>Restart Designer and validate that project can
            open.</para>

            <para>If the overlay was successful, the Java perspective will be
            available (Window --&gt; Open Perspective --&gt; Other --&gt;
            Java). Switch to the Java perspective now and re-organize windows
            as necessary.<tip>
                <para>Any missing Designer views may be re-opened from Window
                --&gt; Open view.</para>
              </tip></para>
          </step>
        </procedure>
      </section>

      <section>
        <title>Installing IdMUnit Components</title>

        <procedure>
          <step>
            <para>Download the release of IdMUnit from <ulink
            url="http://www.idmunit.org/web/guest/downloads">http://www.idmunit.org</ulink>.</para>
          </step>

          <step>
            <para>Unzip the IdMUnit release you downloaded.</para>
          </step>

          <step>
            <para>Import IdMUnit project from the release into Designer.</para>

            <para><orderedlist>
                <listitem>
                  <para>Select File -> Import</para>
                </listitem>

                <listitem>
                  <para>Select "Existing Projects into Workspace" for the import source and click Next.</para>
                </listitem>

                <listitem>
                  <para>For the "Select root directory" input specify the unzipped IdMUnit release directory you created above.</para>
                </listitem>

                <listitem>
                  <para>Select "IdMUnitTests" from the list of "Projects" and click Finish.</para>
                </listitem>
              </orderedlist></para>
          </step>

          <step>
            <para>Creating a New Test Spreadsheet and Runner</para>

            <orderedlist>
              <listitem>
                <para>You are now ready to create the Excel workbook and the
                corresponding Java class for your project. These should be
                created in a sub-directory, typically org\idmunit, of the src
                directory in your project.</para>

                <para>The Excel workbook name must consist of only
                alpa-numeric characters and must not start with a
                number.</para>

                <para>The name of the Java class must match the name of the
                workbook.</para>

                <para>The Java class must extend the
                <type>org.idmunit.IdMUnitTestCase</type> class.</para>

                <para>Any sheets you want to execute from the workbook need a
                corresponding method in the Java class.</para>

                <para>The method should consist of only a call to the
                executeTest method.</para>

                <para><programlisting>public void testMetaToADUserAdd() throws Exception {
    executeTest();
  }
</programlisting></para>

                <para>The Java class must include a suite method with a call
                to DDStepsSuiteFactory.createSuite.</para>

                <para><programlisting>public static Test suite() {
      return DDStepsSuiteFactory.createSuite(YourClass.class);
  }
</programlisting></para>
              </listitem>
            </orderedlist>
          </step>

          <step>
            <para>Basic Test Execution</para>

            <para>Test configurations may be executed as follows:</para>

            <orderedlist>
              <listitem>
                <para>Expand the test project in the Package Explorer view of
                Designer (with Eclipse overlay)</para>
              </listitem>

              <listitem>
                <para>Open the desired test runner in Designer (this file will
                be named with the same name as the target test spreadsheet but
                with a .Java file extension) by double-clicking the file
                name.</para>
              </listitem>

              <listitem>
                <para>Enable or disable the desired test sheets that should be
                executed from the spreadsheet/workbook. Double forward-slash
                will de-activate a line.</para>
              </listitem>

              <listitem>
                <para>Execute the spreadsheet tests by right clicking the
                window (or the file name in the Package Explorer) and run as
                JUnit test.</para>
              </listitem>

              <listitem>
                <para>Monitor progress in the JUnit plug-in of
                Designer.</para>

                <para><tip>
                    <para>After updating test configuration in a particular
                    spreadsheet it should be saved and then refreshed in
                    Designer to pull the latest test configuration into the
                    project. A spreadsheet can be refreshed in Designer by
                    right-clicking and selecting refresh or by hitting F5
                    while selected.</para>
                  </tip></para>
              </listitem>
            </orderedlist>
          </step>
        </procedure>
      </section>
    </section>

    <section id="content_of_install_dir">
      <title>IdMUnit Spreadsheet Content: Identity Management-related Nouns
      and Verbs</title>

      <section>
        <title>Spreadsheet Usage Vocabulary</title>

        <itemizedlist>
          <listitem>
            <para>IdMUnit talks directly to each Identity Manager-connected
            system to generate and validate transactions and data. The
            transactions generated by IdMUnit include all those possible and
            common in identity management integrations such as object add,
            modify, delete, rename, move, enable, disable, password
            initialization, password sync, locked by intruder, etc.</para>
          </listitem>

          <listitem>
            <para>Refer to the IdMUnit 2.0 Reference Spreadsheet for examples
            on all officially supported transactions and validations (found in
            idmunit-core/docs/IdMUnitReference.xls</para>
          </listitem>
        </itemizedlist>
      </section>
    </section>
  </chapter>

  <chapter id="idmunitinstall">
    <title>Configuration</title>

    <section id="idmunitinstall_xxe">
      <title>Configuring IdMUnit</title>

      <section>
        <title>Profile Configuration</title>

        <itemizedlist>
          <listitem>
            <para>Profiles contain a collection of connection information
            required for target systems. A single profile represents all of
            the necessary information required to talk to Identity
            Manager-connected systems within a single environment, like the
            development lab, test lab, or production environment. For
            additional details on the layout of a profile, see
            IdMUnit.dtd.</para>

            <para>Sample profile excerpt:</para>

            <para><inlinemediaobject>
                <imageobject>
                  <imagedata fileref="./images/profileExcerpt.bmp" />
                </imageobject>
              </inlinemediaobject></para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Profile Selection</title>

        <itemizedlist>
          <listitem>
            <para>The &rdquor;live-profile&rdquo; specified at the top of the
            IdMUnit-config.xml file will be the profile used by IdMUnit for
            test execution.</para>

            <para>For example:</para>

            <para><inlinemediaobject>
                <imageobject>
                  <imagedata fileref="./images/profileHeader.bmp" />
                </imageobject>
              </inlinemediaobject></para>

            <para>This configuration would execute tests against the
            connections specified in the &rdquor;trivirLab&rdquo; profile. It
            would also write a log and send email alerts if any tests fail
            that have been marked as "IsCritical" in the spreadsheet.</para>
          </listitem>

          <listitem>
            <para>Profile Use in a Multi-User Environment</para>

            <para>Available upon request in the IdMUnit 2.0 Training Session
            (more info available at info@trivir.com)</para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Password Encryption for Use in the IdMUnit Profile
        Configuration</title>

        <itemizedlist>
          <listitem>
            <para>Passwords need to be encrypted using DES and base-64 encoded
            in order to be used in idmunit-profile.xml. The following steps
            will encrypte and encode a password:</para>
          </listitem>
        </itemizedlist>

        <orderedlist>
          <listitem>
            <para>Open the EncTool class in the Package Explorer</para>
          </listitem>

          <listitem>
            <para>Expand the IdMUnit-core folder in the Package Explorer
            --&gt; expand the org.IdMUnit package --&gt; right-click EncTool
            and select Run-AS --&gt; then select the green Run button</para>
          </listitem>

          <listitem>
            <para>Select Java application in the left pane of the new pop-up
            window</para>
          </listitem>

          <listitem>
            <para>Click the &rdquor;new&rdquo; icon in the top left-hand
            corner and a configuration layout will appear to the right</para>
          </listitem>

          <listitem>
            <para>Select the arguments tab</para>
          </listitem>

          <listitem>
            <para>In the Program Arguments field, type the following where
            mypassword is the actual password of the system like so:</para>
          </listitem>

          <listitem>
            <para><programlisting>IDMUNIT1 mypassword</programlisting></para>
          </listitem>

          <listitem>
            <para>Click Run at the bottom and the password will be encrypted
            with DES and base-64 encoded.</para>
          </listitem>

          <listitem>
            <para>Copy the generated password to the IdMUnit-profiles.xml for
            the target system</para>
          </listitem>

          <listitem>
            <para>Note that the key IDMUNIT1 may be changed, as long as the
            bytes for the key are specified in the top of the EncTool source
            in the &rdquor;iv&rdquo; class member variable:</para>

            <para><programlisting>private final byte[] iv = { 0x0a, 0x01, 0x02, 0x03, 0x04, 0x0b, 0x0c, 0x0d };</programlisting></para>
          </listitem>
        </orderedlist>
      </section>

      <section>
        <title>Import a Certificate into IdMUnit for SSL Communication via the
        LDAP Connector</title>

        <itemizedlist>
          <listitem>
            <para>This procedure follows the steps used to configure a
            standard Java Keystore:</para>

            <orderedlist>
              <listitem>
                <para>Export a DER encoded trusted-root certificate (from the
                target AD DC, eDirectory or other LDAP server)</para>
              </listitem>

              <listitem>
                <para>Copy the DER encoded certificate onto the machine where
                IdMUnit is running. It may be copied into
                IdMUnit/util/security where a batch file resides that will
                help with importing the certificate into a Java certificate
                store</para>
              </listitem>

              <listitem>
                <para>Edit the IdMUnit/util/security/importCert.bat file to
                import the certificate into a known keystore as follows where
                MYCERT.cer is the name of the exported certificate file and
                the MYSSLKEY is the alias name of this certificate in the
                keystore:</para>
              </listitem>

              <listitem>
                <para>SAMPLE importCert.bat:</para>

                <para><programlisting>java sun.security.tools.KeyTool -import -file MYCERT.cer -keystore keystore -alias "type=r.name=MYSSLKEY"</programlisting></para>
              </listitem>

              <listitem>
                <para>When executed, the keytool will ask for a password. Any
                password may be assigned to the keystore (remember this
                password in order to add additional certificates later on).
                The certificate file name and alias name may be parameterized
                with %1 and %2.</para>
              </listitem>
            </orderedlist>
          </listitem>
        </itemizedlist>
      </section>
    </section>
  </chapter>

  <chapter id="tutorial_modular_document">
    <title>Tutorial: Command-line IdMUnit Scripting and Scheduling</title>

    <itemizedlist>
      <listitem>
        <para>Available in the IdMUnit 2.0 Training Session (more info
        available at info@trivir.com)</para>
      </listitem>
    </itemizedlist>
  </chapter>

  <chapter id="being_productive">
    <title id="being_productive_title">Best Practices: Accelerating
    Development, Testing and IDM Productivity with IdMUnit</title>

    <itemizedlist>
      <listitem>
        <para>Available in the IdMUnit 2.0 Training Session (more info
        available at info@trivir.com)</para>
      </listitem>
    </itemizedlist>
  </chapter>

  <appendix>
    <title>Miscellaneous</title>

    <section>
      <title>Install Designer on Linux</title>

      <tip>
        <para>Installing into a virtual machine will provide maximum
        portability and the ability to take configuration snapshots at desired
        intervals</para>
      </tip>

      <procedure>
        <step>
          <para>Download latest release of Designer from <ulink type=""
          url="http://www.novell.com/coolsolutions/dirxml/designer/">here</ulink>
          , extract and install by clicking the "install" script in the
          designer_install directory or invoke it at the command line:</para>

          <programlisting>$ designer_install/install
</programlisting>
        </step>

        <step>
          <para>Execute any platform-specific recommendations as indicated in
          the Designer README displayed after installation. For OpenSUSE the
          following tasks are recommended:</para>

          <para>a. Remove the following lines from the Designer.ini file,
          which is found in the directory where you installed Designer:
           </para>

          <para>-XX:+UseParallelGC</para>

          <para>-XX:ParallelGCThreads=20</para>

          <para>-XX:+UseParallelOldGC</para>

          <para>b. Install the libpng3 package using the Software Management
          component of YaST.</para>

          <para><tip>
              <para>Use df -h to check the disk space on each partition -
              select one that has plenty of room to grow</para>
            </tip><tip>
              <para>Installing into a virtual machine will provide maximum
              portability and the ability to take configuration snapshots at
              desired intervals</para>
            </tip>Launch Designer and validate that the installation was
          successful.</para>
        </step>

        <step>
          <para>Import the current Novell Identity Manager (IDM) project from
          the target eDirectory tree into Designer. See the Designer help for
          instructions as necessary.</para>

          <para>Close designer after importing the project.</para>
        </step>
      </procedure>
    </section>
  </appendix>
</book>
